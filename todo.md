# Learning Adventure - TODO

**最終更新:** 2025-10-29  
**バージョン:** 356bb5fc

---

## 完了済み機能

### コア機能
- [x] データベーススキーマ設計(21テーブル)
- [x] バックエンドAPI実装(tRPC、40+関数)
- [x] 認証システム(ロールベース: admin, teacher, parent, student)
- [x] 生徒ダッシュボード
- [x] 問題回答システム(500問)
- [x] レベル・XP・コインシステム

### ゲーミフィケーション
- [x] ログインボーナスシステム
- [x] ガチャシステム(100アイテム、4段階レアリティ)
- [x] 実績システム(20実績)
- [x] ストーリーシステム(10章、30宝物)
- [x] 学習クイズ統合(32問)
- [x] 10種類の動物キャラクター画像統合

### 管理機能
- [x] 講師ダッシュボード
- [x] 課題作成フォーム
- [x] 問題作成フォーム
- [x] 保護者ダッシュボード(基本機能)
- [x] 管理者ダッシュボード
- [x] ロールベース権限制御

### AI統合
- [x] ChatGPT統合(キャラクター会話)
- [x] OpenAI使用状況記録システム
- [x] トークン・コスト計算

### 最近の改善(2025-10-29)
- [x] 問題チャレンジUI修正(ボタン表示問題)
- [x] ストーリークイズUI修正
- [x] 管理者ロール切り替え改善
- [x] 管理者→生徒画面エラー修正
- [x] OpenAI使用状況表示(管理者画面)
- [x] デイリーミッションシステム(テーブル、API)
- [x] DailyMissionsコンポーネント作成
- [x] 宿題ページ(/tasks)作成

---

## 未完了タスク(優先度順)

### 最優先(システムの核心機能)

#### 1. OpenAI連携改善
- [x] character.chat APIに使用状況記録追加
- [ ] チャット時のAPI呼び出しカウント検証
- [ ] システムコンテクスト改善(学習支援特化)
- [ ] リアルタイム音声会話対応(OpenAI Realtime API)

#### 2. 保護者画面実データ化
- [x] parentChildrenテーブル追加
- [x] 保護者API実装(getMyChildren, addChild, removeChild)
- [ ] weeklyData API実装(週次学習データ)
- [ ] skillData API実装(スキル別進捗データ)
- [ ] recentActivities API実装(最近の活動)
- [ ] 仮データの完全削除

### 高優先度(ユーザー体験向上)

#### 3. テストユーザー設定
- [ ] 生徒480030のユーザー作成
- [ ] 保護者540011のユーザー作成
- [ ] 講師540022のユーザー作成
- [ ] parentChildren登録(540011 - 480030)
- [ ] 講師-生徒関係設定(540022 - 480030)

#### 4. デイリーミッション機能完成
- [x] dailyMissionsテーブル追加
- [x] studentDailyProgressテーブル追加
- [x] デイリーミッションAPI実装
- [x] DailyMissionsコンポーネント作成
- [ ] デイリーミッションマスターデータ登録
- [ ] 問題解答時の自動進捗更新
- [ ] ミッション達成時の報酬付与

#### 5. 管理者画面拡張
- [x] OpenAI使用状況表示
- [ ] グループ管理機能(親-子供、講師-生徒)
- [ ] リレーション設定UI
- [ ] 使用状況ダッシュボード(各ユーザーの活動状況)
- [ ] ユーザー管理機能(作成、編集、削除)

### 中優先度(バグ修正・改善)

#### 6. バグ修正
- [ ] キャラクター選択バグ(選び直し不可)
- [ ] ログインボーナステキスト修正
- [ ] 講師画面キャンセルボタンの挙動

#### 7. データ整備
- [ ] storyChapters重複タイトル修正
- [ ] 初期データ投入(シードスクリプト)

### 低優先度(将来の機能)

#### 8. UI/UX改善
- [ ] Framer Motion導入
- [ ] ページ遷移アニメーション
- [ ] BGM実装(5-10曲)
- [ ] 効果音追加(10種類)
- [ ] 音量調整機能

#### 9. パフォーマンス最適化
- [ ] 画像WebP変換(20MB→6-8MB)
- [ ] 遅延読み込み実装
- [ ] プログレッシブ画像読み込み

#### 10. コード品質向上
- [ ] ルーター分割(server/routers/*.ts)
- [ ] ユニットテスト(Vitest)
- [ ] E2Eテスト(Playwright)
- [ ] API仕様書作成

---

## 既知のバグ

### 重大
- [ ] **キャラクター選択**: 一度選択すると選び直せない(コードは正常、UI確認待ち)

### 軽微
- [ ] **ログインボーナステキスト**: テキストとコメントが一致していない
- [ ] **講師画面**: キャンセルボタンの挙動が不安定
- [ ] **storyChapters**: 同じタイトルのチャプターが存在

---

## 技術的負債

### 軽微
- [ ] server/routers.ts が700行超(将来的に分割推奨)
- [ ] 一部のコンポーネントが大きい(StudentDashboard.tsx等)
- [ ] 画像最適化が未実施(WebP変換等)

### 重大な問題なし

---

## 次のアクション(即座に実施)

1. **テストユーザー設定** - 480030, 540011, 540022の作成と関係設定
2. **デイリーミッションマスターデータ登録** - SQLで直接登録
3. **保護者画面実データ化** - weeklyData, skillData, recentActivities API実装
4. **管理者画面拡張** - グループ管理、リレーション設定UI
5. **バグ修正** - キャラクター選択、ログインボーナステキスト

---

## 長期目標(1-3ヶ月)

- AI生成アセット統合(170画像、25音楽トラック)
- ソーシャル機能追加(友達システム、ランキング)
- 学習コンテンツ拡充(国語・英語)
- 実際の5歳児ユーザーテスト
- 保育園・幼稚園との連携機能
