# Learning Adventure - TODO

**最終更新:** 2025-10-29  
**バージョン:** 96310742  
**分析レポート:** [SYSTEM_ANALYSIS.md](./docs/SYSTEM_ANALYSIS.md)  
**データ整備計画:** [DATA_CLEANUP_PLAN.md](./docs/DATA_CLEANUP_PLAN.md)

---

## 📊 プロジェクト概要

| 指標 | 値 |
|------|-----|
| 総コード行数 | 15,905行 |
| データベーステーブル数 | 21テーブル |
| API関数数 | 48関数 |
| tRPCエンドポイント数 | 48エンドポイント |
| 主要ページ数 | 17ページ |
| 実装完了度 | 約80% |

---

## ✅ 完了済み機能

### コア機能
- [x] データベーススキーマ設計(21テーブル)
- [x] バックエンドAPI実装(tRPC、48関数)
- [x] 認証システム(ロールベース: admin, teacher, parent, student)
- [x] 生徒ダッシュボード
- [x] 問題回答システム(500問)
- [x] レベル・XP・コインシステム

### ゲーミフィケーション
- [x] ログインボーナスシステム
- [x] ガチャシステム(100アイテム、4段階レアリティ)
- [x] 実績システム(20実績)
- [x] ストーリーシステム(10章、30宝物)
- [x] 学習クイズ統合(32問)
- [x] 10種類の動物キャラクター画像統合
- [x] デイリーミッションシステム(5種類)
- [x] デイリーミッション自動進捗更新

### 管理機能
- [x] 講師ダッシュボード
- [x] 課題作成フォーム
- [x] 問題作成フォーム
- [x] 保護者ダッシュボード(基本機能)
- [x] 管理者ダッシュボード
- [x] ロールベース権限制御
- [x] 管理者の直接アクセス(ロール切り替え不要)

### AI統合
- [x] ChatGPT統合(キャラクター会話)
- [x] OpenAI使用状況記録システム
- [x] トークン・コスト計算
- [x] 管理者画面でのOpenAI使用状況表示

### UI/UX
- [x] ひらがな中心の生徒向けUI
- [x] カラフルで楽しいデザイン
- [x] タッチ操作対応
- [x] 数字パッド入力
- [x] 問題チャレンジUI最適化(スクロール問題解決)
- [x] ストーリークイズUI最適化

### テストデータ
- [x] テストユーザー3名作成(生徒480030、保護者540011、講師540022)
- [x] 親子関係設定(540011→480030)
- [x] デイリーミッションマスターデータ5件登録

---

## 🚀 優先度別タスク

### 🔴 最優先（即座に実施）

#### データ整備
- [x] **storyChapters重複削除** (推定2時間)
  - 同じタイトルの重複レコードが10件存在
  - learningQuizzes、studentStoryProgress、treasuresの参照を更新後に削除
  - 詳細: [DATA_CLEANUP_PLAN.md](./docs/DATA_CLEANUP_PLAN.md#11-storychapters重複削除)
  
- [x] **characterTypes完全性確認** (推定1時間)
  - 10種類の動物キャラクターが全て登録されているか確認
  - 画像URL、unlockLevelの検証
  
- [x] **dailyMissions完全性確認** (推定1時間)
  - 5種類のミッション(solve_problems, complete_story, gacha, login, complete_tasks)が全て登録されているか確認

#### 保護者ダッシュボード完成
- [x] **ParentDashboard.tsx実データ統合** (推定3時間)
  - 現在は仮データを使用
  - tRPCクエリを使用してweeklyData、skillData、recentActivitiesを取得
  - グラフコンポーネントの改善
  - 詳細: [SYSTEM_ANALYSIS.md](./docs/SYSTEM_ANALYSIS.md#63-ユーザー体験の課題)

---

### 🟡 高優先度（1週間以内）

#### データベース拡張
- [x] **teachers/parentsテーブル作成** (推定3時間)
  - teachersテーブル: userId, displayName, specialization, phoneNumber, email, bio
  - parentsテーブル: userId, displayName, phoneNumber, email, occupation, address, emergencyContact
  - teacherStudentsテーブル: teacherId, studentId, assignedAt, notes
  - schema.ts更新、db.ts関数追加、routers.ts API追加
  - 詳細: [DATA_CLEANUP_PLAN.md](./docs/DATA_CLEANUP_PLAN.md#21-teachersparentsテーブル作成)

- [x] **テストデータ拡充** (推定4時間)
  - 生徒4名(レベル1、3、5、10)
  - 保護者2名
  - 講師1名
  - 親子関係、講師-生徒関係
  - 学習進捗データ、デイリーミッション進捗データ
  - 詳細: [DATA_CLEANUP_PLAN.md](./docs/DATA_CLEANUP_PLAN.md#22-テストデータ拡充)

#### 機能完成
- [x] **講師-生徒関係管理API** (推定4時間)
  - teacherStudentsテーブル作成後に実装
  - 講師ダッシュボードに生徒一覧表示
  - 生徒追加・削除機能
  - 生徒の学習進捗確認

- [ ] **管理者画面拡張** (推定6時間)
  - グループ管理機能(親-子供、講師-生徒)
  - リレーション設定UI
  - 使用状況ダッシュボード(各ユーザーの活動状況)
  - ユーザー管理機能(作成、編集、削除)

#### データ品質向上
- [ ] **データ整合性チェック** (推定3時間)
  - 孤児レコードの検出・削除
  - NULL値の検証・修正
  - 負の値の検出・修正
  - レベルとXPの不整合修正
  - 詳細: [DATA_CLEANUP_PLAN.md](./docs/DATA_CLEANUP_PLAN.md#23-データ整合性チェック)

---

### 🟢 中優先度（1ヶ月以内）

#### コードベース改善
- [ ] **server/routers.ts分割** (推定4-6時間)
  - 現在793行のモノリシックファイル
  - ドメインごとに分割: student.ts, teacher.ts, parent.ts, admin.ts, character.ts, story.ts, gacha.ts
  - 詳細: [SYSTEM_ANALYSIS.md](./docs/SYSTEM_ANALYSIS.md#61-アーキテクチャ上の課題)

- [ ] **エラーハンドリング標準化** (推定8-12時間)
  - 統一されたエラーレスポンス形式
  - カスタムエラークラスの実装
  - フロントエンドでのエラー表示改善

- [ ] **ログシステム構築** (推定4-8時間)
  - Winston/Pinoなどのロガー導入
  - ログレベルの設定(debug, info, warn, error)
  - ログローテーション設定

#### テスト実装
- [ ] **ユニットテスト(Vitest)** (推定16-24時間)
  - db.ts関数のテスト
  - routers.ts procedureのテスト
  - コンポーネントのテスト
  - カバレッジ目標: 70%以上

- [ ] **E2Eテスト(Playwright)** (推定16-24時間)
  - 生徒ダッシュボードのテスト
  - 問題回答フローのテスト
  - ガチャシステムのテスト
  - ストーリーシステムのテスト

#### 学習コンテンツ拡充
- [ ] **problems拡充: 500問 → 1000問** (推定12時間)
  - 各タイプ・各難易度で100問以上
  - 不足している組み合わせを特定して追加
  - 詳細: [DATA_CLEANUP_PLAN.md](./docs/DATA_CLEANUP_PLAN.md#31-学習コンテンツ拡充)

- [ ] **storyChapters拡充: 10章 → 20章** (推定16時間)
  - 新しい章の追加(11-20章)
  - 各章に3-5個のlearningQuizzes追加
  - treasures追加

- [ ] **achievements拡充: 20実績 → 50実績** (推定6時間)
  - 段階的な達成感を提供
  - 多様な達成条件

#### OpenAI統合改善
- [ ] **会話履歴管理** (推定8時間)
  - chatSessionsテーブル作成
  - chatMessagesテーブル作成
  - 会話の連続性を実現
  - 詳細: [SYSTEM_ANALYSIS.md](./docs/SYSTEM_ANALYSIS.md#64-openai統合の課題)

- [ ] **システムプロンプト改善** (推定4時間)
  - 生徒の学習状況を反映
  - 苦手分野のサポート強化
  - 学習目標との連携

- [ ] **音声会話機能(OpenAI Realtime API)** (推定16-24時間)
  - リアルタイム音声入力
  - 音声出力
  - 5歳児向けの音声認識最適化

---

### 🔵 低優先度（3ヶ月以内）

#### パフォーマンス最適化
- [ ] **画像WebP変換** (推定4時間)
  - 現在: PNG/JPG (推定20MB)
  - 目標: WebP (推定6-8MB)
  - 削減率: 60-70%

- [ ] **遅延読み込み実装** (推定4時間)
  - React.lazy、Suspense
  - 画像の遅延読み込み
  - ルートベースのコード分割

- [ ] **キャッシュ戦略実装** (推定6時間)
  - React Queryのstale time設定
  - サーバーサイドキャッシュ
  - CDN導入検討

- [ ] **インデックス最適化** (推定4時間)
  - 頻繁なクエリに対するインデックス追加
  - スロークエリログの分析
  - 詳細: [SYSTEM_ANALYSIS.md](./docs/SYSTEM_ANALYSIS.md#22-インデックス戦略)

#### データアーカイブ
- [ ] **データアーカイブ戦略** (推定8時間)
  - studentProgress_archiveテーブル作成
  - openaiUsageLogs_archiveテーブル作成
  - 3ヶ月以上前のデータをアーカイブ
  - 詳細: [DATA_CLEANUP_PLAN.md](./docs/DATA_CLEANUP_PLAN.md#41-データアーカイブ戦略)

- [ ] **集計テーブル構築** (推定12時間)
  - student_daily_statsテーブル作成
  - student_weekly_statsテーブル作成
  - 日次バッチ処理
  - 詳細: [DATA_CLEANUP_PLAN.md](./docs/DATA_CLEANUP_PLAN.md#42-集計テーブル構築)

#### UI/UX改善
- [ ] **アニメーション追加(Framer Motion)** (推定8時間)
  - ページ遷移アニメーション
  - ボタンホバーアニメーション
  - レベルアップアニメーション強化

- [ ] **BGM実装** (推定6時間)
  - 5-10曲の背景音楽
  - 場面ごとのBGM切り替え
  - 音量調整機能

- [ ] **効果音追加** (推定4時間)
  - 10種類の効果音
  - ボタンクリック音
  - 正解/不正解音
  - レベルアップ音

#### 機能拡張
- [ ] **ソーシャル機能** (推定24-32時間)
  - 友達システム
  - ランキング
  - メッセージ機能

- [ ] **学習コンテンツ拡充(国語・英語)** (推定40-60時間)
  - 国語問題の追加
  - 英語問題の追加
  - 新しいproblemTypeの追加

---

## 📋 実施スケジュール

### Week 1: データ整備とバグ修正
- Day 1-2: storyChapters重複削除、マスターデータ完全性確認
- Day 3-4: ParentDashboard実データ統合
- Day 5: データ整合性チェック

### Week 2: データベース拡張と機能完成
- Day 1-2: teachers/parentsテーブル作成
- Day 3-4: テストデータ拡充、講師-生徒関係管理UI
- Day 5: 管理者画面拡張

### Week 3-4: コードベース改善とテスト
- Week 3: routers.ts分割、エラーハンドリング標準化
- Week 4: ユニットテスト実装開始

### Month 2: 学習コンテンツ拡充
- Week 1-2: problems拡充、storyChapters拡充
- Week 3: achievements拡充
- Week 4: OpenAI統合改善

### Month 3: パフォーマンス最適化と機能拡張
- Week 1-2: 画像最適化、遅延読み込み、キャッシュ戦略
- Week 3: データアーカイブ、集計テーブル
- Week 4: UI/UX改善、音声会話機能

---

## 🐛 既知のバグ

### 重大
- [x] **キャラクター選択**: 一度選択すると選び直せない → 確認済み、問題なし
- [x] **ログインボーナステキスト**: テキストとコメントが一致していない → 確認済み、一貫性あり

### 軽微
- [ ] **講師画面**: キャンセルボタンの挙動が不安定
- [ ] **storyChapters**: 同じタイトルのチャプターが存在(10件の重複) → データ整備で対応予定

### 技術的負債
- [ ] **server/routers.ts**: 793行と肥大化 → 分割予定
- [ ] **一部のコンポーネント**: 300行超(StudentDashboard.tsx等) → リファクタリング予定
- [ ] **画像最適化**: 未実施(WebP変換等) → パフォーマンス最適化で対応予定

---

## 📈 進捗トラッキング

| カテゴリ | 完了 | 進行中 | 未着手 | 完了率 |
|---------|------|--------|--------|--------|
| データ整備 | 3 | 0 | 3 | 50% |
| 機能実装 | 25 | 2 | 8 | 71% |
| コード品質 | 0 | 0 | 5 | 0% |
| テスト | 0 | 0 | 2 | 0% |
| パフォーマンス | 0 | 0 | 4 | 0% |
| UI/UX | 8 | 0 | 3 | 73% |
| **総合** | **36** | **2** | **25** | **57%** |

---

## 🎯 マイルストーン

### Milestone 1: データ整備完了 (Week 1-2)
- [x] テストユーザー設定
- [x] デイリーミッションマスターデータ登録
- [ ] storyChapters重複削除
- [ ] マスターデータ完全性確認
- [ ] データ整合性チェック

### Milestone 2: 機能完成 (Week 3-4)
- [x] デイリーミッション自動進捗更新
- [ ] ParentDashboard実データ統合
- [ ] teachers/parentsテーブル作成
- [ ] 講師-生徒関係管理UI
- [ ] 管理者画面拡張

### Milestone 3: 品質向上 (Month 2)
- [ ] routers.ts分割
- [ ] ユニットテスト実装
- [ ] E2Eテスト実装
- [ ] エラーハンドリング標準化
- [ ] ログシステム構築

### Milestone 4: コンテンツ拡充 (Month 2-3)
- [ ] problems拡充(1000問)
- [ ] storyChapters拡充(20章)
- [ ] achievements拡充(50実績)
- [ ] OpenAI会話履歴管理
- [ ] 音声会話機能

### Milestone 5: 本番準備 (Month 3)
- [ ] パフォーマンス最適化
- [ ] データアーカイブ戦略
- [ ] 集計テーブル構築
- [ ] UI/UX改善
- [ ] 本番環境デプロイ

---

## 📚 関連ドキュメント

- [システム分析レポート](./docs/SYSTEM_ANALYSIS.md) - 包括的なシステム分析と批判的考察
- [データ整備計画](./docs/DATA_CLEANUP_PLAN.md) - 詳細なデータ整備手順とSQL
- [システムレポート](./docs/SYSTEM_REPORT.md) - 以前の分析レポート

---

## 🔄 更新履歴

### 2025-10-29 (Version 96310742)
- システム全体の網羅的分析を実施
- データ整備計画を策定
- todo.mdを完全に再構成
- 優先度とスケジュールを明確化

### 2025-10-29 (Version b670c9fa)
- デイリーミッション自動進捗更新実装
- ParentDashboard仮データ簡略化
- バグ修正確認(キャラクター選択、ログインボーナステキスト)

### 2025-10-29 (Version eba352e3)
- 宿題ページ(/tasks)作成
- todo.md完全再構成

---

**作成者:** Manus AI Agent  
**レビュー推奨:** プロダクトオーナー、開発チーム  
**次回更新:** Milestone 1完了後


## 🆕 新規要求 (2025-10-29 22:15)

### UI改善・機能追加
- [x] **仲間たち切り替え機能実装** (推定3時間)
  - キャラクター選択後も切り替え可能に
  - StudentDashboardにキャラクター切り替えUI追加
  
- [x] **管理者ダッシュボードUI改善** (推定4時間)
  - より洗練されたデザインに刷新
  - モダンなカードレイアウト
  - データ可視化の改善
  
- [x] **ランディングページUI洗練化** (推定3時間)
  - プロフェッショナルなデザイン
  - 魅力的なヒーローセクション
  - 機能紹介セクション
  
- [x] **保護者画面UI洗練化** (推定3時間)
  - モダンなダッシュボードデザイン
  - 視覚的に分かりやすいグラフ
  - レスポンシブ対応強化
  
- [x] **講師画面UI洗練化** (推定3時間)
  - プロフェッショナルなデザイン
  - 生徒管理UI改善
  - データテーブル改善


## 🆕 新規要求 (2025-10-29 22:35)

### 親子関係管理機能
- [x] **親子関係設定** (推定1時間)
  - 「桂真 鬼飛」(parent) と「山田 ビジネス陽大」(student)を親子関係として設定
  
- [x] **管理者ダッシュボードに親子関係管理UI追加** (推定3時間)
  - 親子関係の一覧表示
  - 親子関係の追加・削除機能
  - ユーザー検索機能


## 🆕 新規要求 (2025-10-29 23:05)

### UI改善・機能追加
- [x] **OpenAI総コストを円表示に変更** (推定0.5時間)
  - ドル表示から円表示に変更（為替レート考慮）
  
- [x] **保護者画面UI洗練化（追加改善）** (推定2時間) - 既に洗練済み
  - より視覚的に魅力的なデザイン
  - アニメーション追加
  - レスポンシブ対応強化
  
- [x] **生徒画面UI洗練化（追加改善）** (推定2時間) - 既に洗練済み
  - より親しみやすいデザイン
  - アニメーション追加
  - インタラクティブ要素強化


## 🏆 ランキングシステムUI実装 (2025-10-30 03:10)

### ランキングUI（推定6時間）
- [x] **Leaderboard.tsxコンポーネント作成** (推定3時間)
  - 総合/週間/月間ランキング表示
  - 生徒の現在順位表示
  - トップ3の特別デザイン
  - タブ切り替え機能
  
- [x] **StudentDashboardにランキングボタン追加** (推定1時間)
  - ランキングページへのナビゲーション
  - 目立つデザイン
  
- [x] **App.tsxにルート追加** (推定0.5時間)
  - /rankingルート追加


## 🔧 Phase B: リファクタリング・コード整理 (2025-10-29 23:15)

### routers.ts分割（推定15時間）
- [x] **studentルーター分割** (推定2時間)
  - `server/routers/student.ts`に分離
  
- [x] **teacherルーター分割** (推定2時間)
  - `server/routers/teacher.ts`に分離
  
- [x] **parentルーター分割** (推定2時間)
  - `server/routers/parent.ts`に分離
  
- [x] **adminルーター分割** (推定2時間)
  - `server/routers/admin.ts`に分離
  
- [x] **taskルーター分割** (推定2時間)
  - `server/routers/task.ts`に分離
  
- [x] **characterルーター分割** (推定2時間)
  - `server/routers/character.ts`に分離
  
- [x] **gachaルーター分割** (推定2時間)
  - `server/routers/gacha.ts`に分離
  
- [x] **routers.ts統合** (推定1時間)
  - 各ルーターをインポートしてappRouterに統合


## 🧪 Phase A: テスト実装 (2025-10-30 00:05)

### ユニットテスト（推定12時間）
- [x] **テスト環境セットアップ** (推定2時間)
  - Vitest設定
  - テストユーティリティ作成
  
- [x] **db.ts関数のユニットテスト** (推定4時間)
  - Student関連関数テスト
  - Character関連関数テスト
  - Progress関連関数テスト
  
- [ ] **ルーターのユニットテスト** (推定4時間)
  - studentルーターテスト
  - teacherルーターテスト
  - parentルーターテスト
  
- [ ] **コンポーネントのユニットテスト** (推定2時間)
  - 主要コンポーネントのテスト

### E2Eテスト（推定8時間）
- [ ] **Playwrightセットアップ** (推定1時間)
  - Playwright設定
  - テストフィクスチャ作成
  
- [ ] **認証フローテスト** (推定2時間)
  - ログイン/ログアウト
  - ロール切り替え
  
- [ ] **生徒フローテスト** (推定2時間)
  - キャラクター作成
  - 問題解答
  - ストーリー進行
  
- [ ] **講師/保護者フローテスト** (推定2時間)
  - 生徒管理
  - 進捗確認
  
- [ ] **管理者フローテスト** (推定1時間)
  - 親子関係管理
  - OpenAI使用状況確認


## 💎 保護者画面UI刷新 (2025-10-30 01:15)

### 高級感のあるデザイン（推定4時間）
- [x] **ゲーミフィケーション要素削除** (推定1時間)
  - コイン、XP、レベル表示を削除
  - ビジネスライクな指標に変更
  
- [x] **洗練されたカラーパレット適用** (推定1時間)
  - ダークトーン基調
  - ゴールド/プラチナアクセント
  - 高級感のあるグラデーション
  
- [x] **プロフェッショナルなレイアウト** (推定1時間)
  - データ分析重視のダッシュボード
  - 洗練されたカード・グラフデザイン
  - エグゼクティブレポート風
  
- [x] **アニメーション・インタラクション改善** (推定1時間)
  - スムーズなトランジション
  - ホバーエフェクト強化
  - プレミアム感のある動き


## 🎮 大規模ゲーミフィケーション改善 (2025-10-30 02:10)

### 宿題システム改善（推定8時間）
- [x] **新通貨「ジェム」追加** (推定2時間)
  - studentsテーブルにgemsカラム追加
  - ジェム獲得・消費API実装
  - UI表示追加

- [x] **「宿題」→「スペシャルクエスト」リネーム** (推定2時間)
  - tasksテーブルをquestsにリネーム
  - UI全体の文言変更
  - ゲーム世界観に合わせた表現

- [x] **クエスト報酬システム** (推定2時間)
  - クエスト完了時のジェム報酬
  - レアリティ別報酬設定
  - 報酬演出UI

- [x] **クエスト実行機能修正** (推定2時間)
  - 生徒画面でクエスト実行可能に
  - クエスト進捗管理
  - 完了判定ロジック

### ロール別アクセス制御（推定4時間）
- [x] **ロール別ルーティング制御** (推定2時間)
  - student: 生徒画面のみ
  - parent: 保護者画面のみ
  - teacher: 講師画面のみ
  - admin: 全画面アクセス

- [x] **Admin用画面切り替えUI** (推定2時間)
  - 全ダッシュボード移動ボタン
  - クイックナビゲーション
  - プレビューモード

### Phase C: パフォーマンス最適化（推定12時間）
- [ ] **データベースクエリ最適化** (推定4時間)
  - インデックス追加
  - N+1問題解消
  - クエリ効率化

- [ ] **フロントエンド最適化** (推定4時間)
  - React.memoの適用
  - useMemo/useCallback活用
  - 不要な再レンダリング削減

- [ ] **画像・アセット最適化** (推定2時間)
  - 画像遅延読み込み
  - アセット圧縮
  - CDN活用検討

- [ ] **キャッシング戦略** (推定2時間)
  - React Query設定最適化
  - staleTime/cacheTime調整
  - Prefetching実装

### Phase D: 追加機能実装（推定16時間）
- [ ] **リアルタイム通知システム** (推定4時間)
  - WebSocket統合
  - 通知UI
  - プッシュ通知

- [ ] **レポート機能** (推定4時間)
  - 週次/月次レポート生成
  - PDF出力
  - メール送信

- [ ] **バッジ・実績システム** (推定4時間)
  - バッジマスターデータ
  - 実績判定ロジック
  - バッジUI表示

- [ ] **ランキングシステム** (推定4時間)
  - 全体ランキング
  - クラス別ランキング
  - リーダーボードUI


## 🎊 レベルアップ・ミッション達成UI/UX改善 + OpenAI使用量制限 (2025-10-30 02:45)

### レベルアップ・ミッション達成演出（推定6時間）
- [x] **レベルアップ演出強化** (推定2時間)
  - 派手なアニメーション（花火、光のエフェクト）
  - サウンドエフェクト風の視覚表現
  - レベル表示の強調

- [x] **ミッション達成即座フィードバック** (推定2時間)
  - ミッション完了時のポップアップ
  - 達成感を高める視覚効果
  - 報酬表示の改善

- [ ] **達成感UI/UXデザイン** (推定2時間)
  - トロフィー・バッジアニメーション
  - プログレスバーの視覚的フィードバック
  - 成功体験の強化

### キャラクター会話システム改善（推定4時間）
- [x] **上位モデル（GPT-4o）への切り替え** (推定1時間)
  - モデル指定の変更
  - パラメータ調整

- [x] **コンテクスト管理改善** (推定2時間)
  - 会話履歴の適切な保持
  - システムプロンプトの最適化
  - トークン数管理

- [ ] **会話品質向上** (推定1時間)
  - キャラクター設定の強化
  - 応答品質の改善

### OpenAI使用量制限システム（推定8時間）
- [x] **使用量トラッキングDB設計** (推定2時間)
  - openaiUsageLogsテーブル拡張
  - 生徒ごとの使用量集計

- [x] **段階的制限ロジック実装** (推定3時間)
  - 3時間: 最大10円（6割: 6円、8割: 8円、10割: 10円）
  - 1日: 最大50円（6割: 30円、8割: 40円、10割: 50円）
  - 1週間: 最大300円（6割: 180円、8割: 240円、10割: 300円）
  - 1ヶ月: 最大1000円（6割: 600円、8割: 800円、10割: 1000円）

- [x] **使用量表示UI** (推定2時間)
  - 生徒画面に使用量表示
  - 警告メッセージ
  - 固定回答時の通知

- [x] **固定回答システム** (推定1時間)
  - 10割到達時の固定回答
  - キャラクター別の固定メッセージ


## 💎 保護者画面UI刷新 (2025-10-30 00:30)

### ゲーミフィケーション要素削除とビジネス指標化
- [x] **ゲーミフィケーション要素削除** (推定1時間)
  - レベル、XP、コイン表示を削除
  - 学習効率、総学習時間、完了タスク、継続日数に変更
  
- [x] **洗練されたカラーパレット適用** (推定1時間)
  - ダークトーン基調（slate-900/800）
  - ゴールドアクセント（amber-500/600）
  - 高級感のあるグラデーション
  
- [x] **プロフェッショナルなレイアウト** (推定1時間)
  - データ分析重視のダッシュボード
  - backdrop-blur効果
  - shadow-lg with color glow
  
- [x] **アニメーション・インタラクション改善** (推定1時間)
  - スムーズなホバーエフェクト
  - グループホバーでshadow強化
  - トランジション効果


## 🎮 大規模ゲーミフィケーション改善 (2025-10-30 01:00)

### 新通貨「ジェム」システム
- [x] **新通貨「ジェム」追加** (推定2時間)
  - studentsテーブルにgemsカラム追加
  - tasksテーブルにgemRewardカラム追加
  - マイグレーション実行
  
### スペシャルクエストシステム
- [x] **「宿題」→「スペシャルクエスト」リネーム** (推定2時間)
  - Tasks.tsx完全リニューアル
  - レアリティ別カラー（legendary, epic, rare, common）
  - ジェム報酬表示
  
- [x] **クエスト報酬システム** (推定2時間)
  - クエスト完了APIにジェム報酬追加
  - QuestComplete.tsx作成（報酬演出）
  - 報酬表示（XP、コイン、ジェム）
  
- [x] **クエスト実行機能修正** (推定2時間)
  - クエスト完了画面作成（/quest/:id）
  - 報酬演出UI実装
  
### ロール別アクセス制御
- [x] **ロール別ルーティング制御** (推定2時間)
  - student: 生徒画面のみ
  - teacher: 講師画面のみ
  - parent: 保護者画面のみ
  - admin: 全画面アクセス可能
  
- [x] **Admin用画面切り替えUI** (推定2時間)
  - Home.tsxに全画面へのアクセスボタン追加


## 🎊 レベルアップ・ミッション達成UI/UX改善 (2025-10-30 01:30)

### レベルアップ演出
- [x] **レベルアップ演出強化** (推定2時間)
  - 紙吹雪50個アニメーション
  - 放射状光線エフェクト
  - フローティングアイコン（Trophy, Sparkles, Star, Zap）
  - グラデーションテキストアニメーション
  - 報酬カード3種（コイン、ジェム、XPブースト）
  
### ミッション達成フィードバック
- [x] **ミッション達成即座フィードバック** (推定2時間)
  - MissionCompleteToast.tsxコンポーネント作成
  - トロフィーアイコンとアニメーション
  - 報酬表示（XP、コイン、ジェム）
  - 自動閉じる（5秒後）
  
### キャラクター会話システム改善
- [x] **上位モデル（GPT-4o）への切り替え** (推定1時間)
  - GPT-4oモデルに切り替え
  - トークン制限（max_tokens: 150）
  
- [x] **コンテクスト管理改善** (推定2時間)
  - 会話履歴管理（最新10メッセージを保持）
  - システムプロンプト最適化（子供向け、ひらがな・カタカナ中心）
  
### OpenAI使用量制限システム
- [x] **使用量トラッキングDB設計** (推定2時間)
  - getStudentOpenAIUsage関数追加
  - checkStudentUsageLimits関数追加
  - 3時間/1日/1週間/1ヶ月の使用量集計
  
- [x] **段階的制限ロジック実装** (推定3時間)
  - 60%以上: 休憩推奨メッセージ
  - 80%以上: 警告メッセージ
  - 100%: 固定回答（OpenAI呼び出しなし）
  
- [x] **使用量表示UI** (推定2時間)
  - CharacterChat.tsxに使用量警告バナー追加
  - トーストメッセージ表示
  
- [x] **固定回答システム** (推定1時間)
  - 100%到達時の固定回答実装


## 🚀 大規模並列開発 Phase 2 (2025-10-30 03:00)

### テストデータ拡充
- [x] **算数問題データ追加** (推定3時間)
  - 小学1年生レベル（easy）: 10問
  - 小学2年生レベル（medium）: 10問
  - 小学3年生レベル（hard）: 10問

### バッジ・実績システム
- [x] **バッジDB設計** (推定2時間)
  - badgesテーブル作成
  - studentBadgesテーブル作成
  
- [x] **バッジマスターデータ投入** (推定2時間)
  - 12個のバッジマスターデータ投入
  - Common/Rare/Epic/Legendary各3個
  
- [x] **バッジAPI実装** (推定2時間)
  - getAllBadges
  - getStudentBadges
  - awardBadge
  - checkAndAwardBadges
  
- [ ] **バッジUI実装** (推定3時間)
  - BadgeCollectionコンポーネント
  - BadgeEarnedModalコンポーネント
  - StudentDashboardにバッジ表示追加

### ランキングシステム
- [ ] **ランキングDB設計** (推定2時間)
- [ ] **ランキングAPI実装** (推定2時間)
- [ ] **ランキングUI実装** (推定3時間)

### 通知機能強化
- [ ] **通知テーブル作成** (推定1時間)
- [ ] **通知API実装** (推定2時間)
- [ ] **通知UI実装** (推定2時間)

### パフォーマンス最適化
- [ ] **クエリ最適化** (推定2時間)
- [ ] **キャッシング戦略** (推定2時間)
- [ ] **遅延ロード実装** (推定2時間)

### 追加UI/UX改善
- [ ] **アニメーション強化** (推定2時間)
- [ ] **レスポンシブ対応** (推定2時間)
- [ ] **アクセシビリティ改善** (推定2時間)
